is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
radius=100
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
is.na(newdata) %>% sum()
while(sum(is.na(newdata))==0)  newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(df)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
radius = 50
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
radius = 50
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- simulate_data(data=data, preds=preds, coords=coords, pred_ras=pred_ras, variog=variog, method=method, radius=radius)
nrow(newdata)
newdata <- shift_rotate(data, coords, radius)
is.na(newdata) %>% sum
newdata <- rotate(data, coords)
for (pred in preds){
newdata[,pred] <- st_extract(pred_ras[[pred]], cbind(newdata[,coords[1]],newdata[,coords[2]]))[[1]]
}
is.na(newdata) %>% sum
which(is.na(newdata))
apply(newdata, 1, is.na)
apply(newdata, 1, is.na %>% min)
min(F,T)
max(F,T)
max(F,F)
apply(newdata, 1, function(row) max(is.na(row)))
apply(newdata, 1, function(row) max(is.na(row))) %>% which
apply(newdata, 1, function(row) max(is.na(row))) == 0
which(apply(newdata, 1, function(row) max(is.na(row))) == 0)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='shift')
sums <- summarize_null_models(ms, df)
coef_tab(sums)
pred_tab(sums)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
pred_tab(sums)
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='kriging')
sums <- summarize_null_models(ms, df)
coef_tab(sums)
pred_tab(sums)
coef_plot(m, sums)
effect_plot(m, ms, df)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
effect_plot(m, ms, df)
sample(1:nrow(data), size = nrow(data), replace = F)
?dist
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='viladomat', nsim=10)
sums <- summarize_null_models(ms, df)
coef_tab(sums)
prctile <- quantile(dist(df[,coords]), probs = 0.25)
variog <- lapply(preds, function(pred)
variog(data = df[,pred], coords = df[,coords], max.dist = prctile, option = "bin", messages = FALSE)
)
names(variog) <- preds
newdf <- simulate_data(df, preds, variog = variog, method = "viladomat", prctile = prctile)
newdf == df
newdf$newdata == df
newdf$newdata %>% View
View(df)
newdf$newdata %>% nrow
df %>% nrow
sum(is.na(df))
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram()
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "frequency")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "viladomat", prctile = prctile)
nrow(newdf)
nrow(newdf$newdata)
df[,1]
df[,1] %>% length
df[1:10,1] %>% length
df[(1:10),1] %>% length
df[(1:10),1]
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "viladomat", prctile = prctile)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "viladomat", prctile = prctile)
is.na(df$p1) %>% sum
is.na(df$p2) %>% sum
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "viladomat", prctile = prctile)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf <- simulate_data(df, preds, variog = variog, method = "viladomat", prctile = prctile)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density", alpha=.5)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density", alpha=.1)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density", alpha=.3)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile)
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
variog2 <- lapply(preds, function(pred) fitme(as.formula(paste(pred,"~1+Matern(1|",coords[1],"+",coords[2],")", sep="")), data=data))
names(variog2) <- preds
newdf <- simulate_data(df, preds, variog = variog2, method = "RFsim")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
?likfit
variog3 <- lapply(preds, function(pred){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
if (!fixed_nugget) nuggets <- c(nuggets, vgm$nugget)
switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2]))
})
var_model = !mat
var_model = "mat"
variog3 <- lapply(preds, function(pred){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
if (!fixed_nugget) nuggets <- c(nuggets, vgm$nugget)
switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2]))
})
fixed_nugget = TRUE
nugget = 0
variog3 <- lapply(preds, function(pred){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
if (!fixed_nugget) nuggets <- c(nuggets, vgm$nugget)
switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2]))
})
kappa = 1.5
variog3 <- lapply(preds, function(pred){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
if (!fixed_nugget) nuggets <- c(nuggets, vgm$nugget)
switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2]))
})
names(variog3) <- preds
RFsimulate(RMnugget(var=0))$variable1
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf <- simulate_data(df, preds, variog = variog3, method = "RFsim")
variog3 <- lapply(preds, function(pred){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
nuggets <- c(nuggets, if (!fixed_nugget) vgm$nugget else nugget)
switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2]))
})
nuggets <- numeric(0)
variog3 <- lapply(preds, function(pred){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
nuggets <- c(nuggets, if (!fixed_nugget) vgm$nugget else nugget)
switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2]))
})
names(variog3) <- preds
names(nuggets) <- preds
variog3 <- lapply(preds, function(pred){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
nuggets <- c(nuggets, if (!fixed_nugget) vgm$nugget else nugget)
switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2]))
})
nuggets <- numeric(0)
variog3 <- list(0)
for (pred in preds){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
nuggets <- c(nuggets, if (!fixed_nugget) vgm$nugget else nugget)
variog3 <- c(variog3, switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2])))
}
variog3 <- list()
for (pred in preds){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
nuggets <- c(nuggets, if (!fixed_nugget) vgm$nugget else nugget)
variog3 <- c(variog3, switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2])))
}
names(variog3) <- preds
names(nuggets) <- preds
nuggets <- numeric(0)
variog3 <- list()
for (pred in preds){
vgm <- likfit(data=data[,pred],
coords = cbind(data[,coords[1]], data[,coords[2]]),
cov.model = var_model, kappa = kappa,
ini.cov.pars = c(var(data[,pred]), max(max(data[,coords[1]])-min(data[,coords[1]]),
max(data[,coords[2]])-min(data[,coords[2]]))),
fix.nugget = fixed_nugget, nugget = nugget,
messages = F)
nuggets <- c(nuggets, if (!fixed_nugget) vgm$nugget else nugget)
variog3 <- c(variog3, switch(var_model,
"mat" = RMwhittle(nu=kappa, var = vgm$cov.pars[1], scale = vgm$cov.pars[2])))
}
names(variog3) <- preds
names(nuggets) <- preds
newdf <- simulate_data(df, preds, variog = variog3, method = "RFsim")
nuggets["p1"]
newdf <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim")
newdf1 <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile)
newdf2 <- simulate_data(df, preds, variog = variog2, method = "kriging", prctile = prctile)
newdf2 <- simulate_data(df, preds, variog = variog2, method = "kriging", radius = 50)
newdf3 <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim")
newdf <- newdf1
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf <- newdf2
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf <- newdf3
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf3 <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim")
newdf <- newdf3
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf3 <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf3 <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1
RFsimulate(variog[[pred]], x=data[,coords[1]], y=data[,coords[2]])$variable1
RFsimulate(variog[[pred]], x=data[,coords[1]], y=data[,coords[2]])$variable1
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
RFsimulate(variog3[["p1"]], x=data[,coords[1]], y=data[,coords[2]])$variable1 %>% hist()
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf3 <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim")
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf1 <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile)
newdf2 <- simulate_data(df, preds, variog = variog2, method = "kriging", radius = 50)
newdf3 <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim")
newdf <- newdf1
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf <- newdf2
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf <- newdf3
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
newdf3 <- simulate_data(df, preds, variog = variog3, nuggets = nuggets, method = "RFsim", center_data = T)
newdf <- newdf3
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
newdf1 <- simulate_data(df, preds, variog = variog, method = "Viladomat", prctile = prctile, center_data = T)
newdf <- newdf1
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p1, fill=orig)) + geom_histogram(stat = "density")
rbind(df %>% mutate(orig="orig"), newdf$newdata %>% mutate(orig="new")) %>% ggplot(aes(x=p2, fill=orig)) + geom_histogram(stat = "density")
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='shift', nsim=10)
sums <- summarize_null_models(ms, df)
coef_tab(sums)
coef_plot(m, sums)
effect_plot(m, ms, df)
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='Viladomat', nsim=10)
sums <- summarize_null_models(ms, df)
coef_tab(sums)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='Viladomat', nsim=100)
sums <- summarize_null_models(ms, df)
effect_plot(m, ms, df)
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='Viladomat', nsim=100, center_data = F)
effect_plot(m, ms, df)
sums <- summarize_null_models(ms, df)
coef_tab(sums)
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='RFsim', nsim=100, center_data = F)
source("R/simulate_null_models.R")
source("R/summarize_null_models.R")
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='RFsim', nsim=100, center_data = F)
sums <- summarize_null_models(ms, df)
effect_plot(m, ms, df)
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='RFsim', nsim=100, center_data = T)
effect_plot(m, ms, df)
sums <- summarize_null_models(ms, df)
coef_tab(sums)
pred_tab(sums)
coef_plot(m, sums)
effect_plot(m, ms, df)
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='RFsim', nsim=1000, center_data = T)
sums <- summarize_null_models(ms, df)
effect_plot(m, ms, df)
coef_tab(sums)
m.glm <- glm(resp~p1 + p2, data=df, family=binomial)
m <- m.glm
ms <- simulate_null_models(m, df, radius = 50, pred_ras=list(p1=r.pred, p2=r2.pred), method='RFsim', nsim=1000, center_data = T)
effect_plot(m, ms, df)
coef_tab(sums)
plots <- lapply(1:nrow(params), function(row){
print(params[row,])
method=params[row,"method"]
scale=params[row,"scale"]
radius=params[row,"radius"]
mod.pred <- RMwhittle(nu=1.5, var=1, scale=scale)
mod.resp <- RMwhittle(nu=1.5, var=1, scale=scale)
r.pred <- RFsimulate(mod.pred, x=0:100, y=0:100, grid=T) %>% st_as_stars
r.resp <- r.pred + (RFsimulate(mod.resp, x=0:100, y=0:100, grid=T) %>% st_as_stars)
x <- runif(100, 0, 100)
y <- runif(100, 0, 100)
predictor <- st_extract(r.pred, cbind(x,y))$variable1
response <- st_extract(r.resp, cbind(x,y))$variable1
df <- data.frame(x=x, y=y, predictor=predictor, response=response)
m <- lm(response~predictor, data=df)
ms <- simulate_null_models(m, df, radius = radius, pred_ras=list(predictor=r.pred), method=method)
effect_plot(m, ms, df) +
labs(title=paste("Method = ",method,", Radius = ",radius,", Scale = ",scale,sep=""))
})
params <- expand.grid(method=c("kriging","shift"), radius=c(10,50,100), scale=c(1,10,50))
plots <- lapply(1:nrow(params), function(row){
print(params[row,])
method=params[row,"method"]
scale=params[row,"scale"]
radius=params[row,"radius"]
mod.pred <- RMwhittle(nu=1.5, var=1, scale=scale)
mod.resp <- RMwhittle(nu=1.5, var=1, scale=scale)
r.pred <- RFsimulate(mod.pred, x=0:100, y=0:100, grid=T) %>% st_as_stars
r.resp <- r.pred + (RFsimulate(mod.resp, x=0:100, y=0:100, grid=T) %>% st_as_stars)
x <- runif(100, 0, 100)
y <- runif(100, 0, 100)
predictor <- st_extract(r.pred, cbind(x,y))$variable1
response <- st_extract(r.resp, cbind(x,y))$variable1
df <- data.frame(x=x, y=y, predictor=predictor, response=response)
m <- lm(response~predictor, data=df)
ms <- simulate_null_models(m, df, radius = radius, pred_ras=list(predictor=r.pred), method=method)
effect_plot(m, ms, df) +
labs(title=paste("Method = ",method,", Radius = ",radius,", Scale = ",scale,sep=""))
})
library(gridExtra)
grid.arrange(grobs=plots, ncol=6)
plots <- lapply(1:nrow(params), function(row){
print(params[row,])
method=params[row,"method"]
scale=params[row,"scale"]
radius=params[row,"radius"]
mod.pred <- RMwhittle(nu=1.5, var=1, scale=scale)
mod.resp <- RMwhittle(nu=1.5, var=1, scale=scale)
r.pred <- RFsimulate(mod.pred, x=0:100, y=0:100, grid=T) %>% st_as_stars
r.resp <- r.pred + (RFsimulate(mod.resp, x=0:100, y=0:100, grid=T) %>% st_as_stars)
x <- runif(100, 0, 100)
y <- runif(100, 0, 100)
predictor <- st_extract(r.pred, cbind(x,y))$variable1
response <- st_extract(r.resp, cbind(x,y))$variable1
df <- data.frame(x=x, y=y, predictor=predictor, response=response)
m <- lm(response~predictor, data=df)
ms <- simulate_null_models(m, df, radius = radius, pred_ras=list(predictor=r.pred), method=method)
effect_plot(m, ms, df) +
labs(title=paste(method, "r =", radius, scale))
})
grid.arrange(grobs=plots, ncol=6)
save(ms, file = "size.RData")
cft <- coef_tab(sums)
cft
cft["p1","P.value"]
coef_tab(ms)
citation("ctmm")
citation("adehabitatHR")
update.packages("adehabitatHR")
citation("adehabitatHR")
citaion("ctmm")
citation("ctmm")
?ctmm::ctmm.select
